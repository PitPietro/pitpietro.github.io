<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="description" content="Personal website" />
        <meta name="author" content="Pietro Poluzzi" />
        <!-- responsive meta tag -->
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Singleton</title>
        <link rel="shortcut icon" type="image/png" href="../../../img/icon/pit_64.png" />
        <link href="../../../css/style.css" rel="stylesheet" />
        <script type="text/javascript" src="../../../js/include-html.js"></script>
        <script type="text/javascript" src="../../../js/dropdown-menu.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    </head>
    <body class="body-color">
        <nav class="navbar navbar-expand-lg navbar-dark bg-info fixed-top">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <a class="navbar-brand" href="../../../index.html">
                <img src="../../../img/icon/pit_200-100.png" height="80%" width="80%" alt="Pit Logo">
            </a>
            <div class="collapse navbar-collapse" id="navbarResponsive">
              <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="#"><i>Back on top</i></a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="#problem">Problem</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="#solution">Solution</a>
                </li>
                <li class="nav-item dropdown">
                  <a class="nav-link active dropdown-toggle" href="#structure" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Structure
                  </a>
                  <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                    <li><a class="dropdown-item" href="#uml">UML</a></li>
                    <li class="dropdown-submenu">
                      <a class="dropdown-item dropdown-toggle" href="#java">Java</a>
                      <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#java-thread-safe">Thread Safe</a></li>
                        <li class="dropdown-submenu">
                          <a class="dropdown-item dropdown-toggle" href="#java-non-thread-safe">Non-Thread Safe</a>
                          <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#java-single-thread">Single Thread</a></li>
                            <li><a class="dropdown-item" href="#java-multi-thread">Multi-Thread</a></li>
                          </ul>
                        </li>
                      </ul>
                    </li>
                    <li class="dropdown-submenu">
                        <a class="dropdown-item dropdown-toggle" href="#kotlin">Kotlin</a>
                        <ul class="dropdown-menu">
                          <li><a class="dropdown-item" href="#kotlin-thread-safe">Thread Safe</a></li>
                          <li class="dropdown-submenu">
                            <a class="dropdown-item dropdown-toggle" href="#kotlin-non-thread-safe">Non-Thread Safe</a>
                            <ul class="dropdown-menu">
                              <li><a class="dropdown-item" href="#kotlin-single-thread">Single Thread</a></li>
                              <li><a class="dropdown-item" href="#kotlin-multi-thread">Multi-Thread</a></li>
                            </ul>
                          </li>
                        </ul>
                    </li>
                    <li class="dropdown-submenu">
                        <a class="dropdown-item dropdown-toggle" href="#c-sharp">C#</a>
                        <ul class="dropdown-menu">
                          <li><a class="dropdown-item" href="#c-sharp-thread-safe">Thread Safe</a></li>
                          <li><a class="dropdown-item" href="#c-sharp-non-thread-safe">Non-Thread Safe</a></li>
                        </ul>
                    </li>
                    <li><a class="dropdown-item" href="#php">PHP</a></li>
                    <li><a class="dropdown-item" href="#python">Python</a></li>
                  </ul>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="#real-world">Real world implementation</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="#pros-cons">Pros & Cons</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="#conclusion">Conclusion</a>
                </li>
              </ul>
            </div>
          </nav>

        <!-- START of the body content-->
        <div class="container margin-120">
          <div class="page-header">
              <h1 class="text-center">Singleton Pattern</h1>
          </div>
          <div class="container-fluid">
              <p class="text-justify">
                Singleton is a <a href="dp-index.html#title-creational-patterns">Creational Pattern</a>. It ensures that a class has only one instance and provides a global access point to the instance. The code is available on <b>GitHub</b> under a MIT license to allow a better code readability. Nevertheless, I'll link even the single files in the <i>structure</i> slice of the page website.
              </p>
              <p><a href="https://github.com/PitPietro/java-kotlin-design-patterns">
                PitPietro/java-kotlin-design-patterns
              </a></p>
              <h2 id="problem">Problem</h2>
              <p>
                This pattern violates the <i>Sin­gle Respon­si­bil­i­ty Prin­ci­ple</i> but solves two problems at the same time:
                <ol>
                  <li><b>Ensure that a class has just a single instance</b></li>
                  <li><b>Provide a global access point to that instance</b></li>
                </ol>
              </p>
              <p>
                Assume your program creates an object and after a while it creates a new one of the same type. Instead of receiving a new object, you get the one already created.
                <br><b>P.N.</b> The constructor must be <i>private</i> or <i>protected</i> because the default constructor always return a new object.The Singleton lets you access an object from any point in the program and it also protects that instance from being overwritten by other part of the code.
              </p>
              <h2 id="solution">Solution</h2>
              <p>There are mainly two steps to care about. The first is to make the constructor  <i>private</i> or <i>protected</i> (as I wrote above). The second is to provide the Singleton class whit a <i>public static</i> method that acts like a constructor. This method, as you’ll see in the code below, must be <i>thread safe</i>. It calls the constructor and saves a class instance in a static variable, then returns the same instance when the program tries to create a new once.</p>
              <h2>Structure</h2>
              <h4 id="uml">UML</h4>
              <div class="c">
                <img src="../../../img/dp/singleton.png" height="50%" width="50%" alt="singleton-uml">
              </div>
              <br>
              <h4 id="java">
                Java
                <a target="_blank" rel="noopener noreferrer" href="https://github.com/PitPietro/java-kotlin-design-patterns/tree/master/src/com/pit/java/singleton">
                  <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" version="1.1">
                    <rect style="opacity:0.2" width="50" height="32" x="7" y="24" rx="2.5" ry="2.5"/>
                    <path style="fill:#4877b1" d="M 7,44.5 C 7,45.885 8.115,47 9.5,47 H 54.5 C 55.885,47 57,45.885 57,44.5 V 17.5 C 57,16.115 55.885,15 54.5,15 H 29 V 12.5 C 29,11.115 27.885,10 26.5,10 H 9.5 C 8.115,10 7,11.115 7,12.5"/>
                    <rect style="opacity:0.2" width="50" height="32" x="7" y="22" rx="2.5" ry="2.5"/>
                    <rect style="fill:#e4e4e4" width="44" height="20" x="10" y="18" rx="2.5" ry="2.5"/>
                    <rect style="fill:#5294e2" width="50" height="32" x="7" y="23" rx="2.5" ry="2.5"/>
                    <path style="opacity:0.1;fill:#ffffff" d="M 9.5,10 C 8.115,10 7,11.115 7,12.5 V 13.5 C 7,12.115 8.115,11 9.5,11 H 26.5 C 27.885,11 29,12.115 29,13.5 V 12.5 C 29,11.115 27.885,10 26.5,10 Z M 29,15 V 16 H 54.5 C 55.89,16 57,17.115 57,18.5 V 17.5 C 57,16.115 55.89,15 54.5,15 Z"/>
                    <path style="fill:#1d344f" d="M 29,27 C 29,27 30.154,27.706 29.34,29.562 28.108,32.36 30.477,33 30.477,33 30.477,33 29.724,32.344 30.727,30.035 31.835,27.477 29,27 29,27 Z M 33.199,30.855 C 33.199,30.855 31.102,31.787 32.453,34.332 33.346,36.019 32.355,36.855 32.355,36.855 32.355,36.855 34.889,36.02 33.667,33.691 32.569,31.586 33.199,30.855 33.199,30.855 Z M 26.671,31 C 26.671,31 25.169,32.599 26.656,34.562 27.639,35.869 26.996,37 26.996,37 26.996,37 28.857,35.349 27.511,33.543 26.296,31.913 26.671,31 26.671,31 Z M 26.996,37 H 22 L 25,49 H 36 L 36.679,47.031 C 37.012,47.114 37.356,47.172 37.714,47.172 40.08,47.171 42,45.651 42,43.284 42,41.276 40.613,39.604 38.748,39.14 L 39.143,37 26.995,36.999 Z M 38.406,40.519 C 38.422,40.521 38.437,40.524 38.453,40.527 39.215,40.732 39.501,42.132 39.093,43.656 38.694,45.142 37.779,46.202 37.023,46.055 Z"/>
                  </svg>
                </a>
              </h4>
              <p>Click on the icon next to the title to look at the code.</p>
              <h5 id="java-thread-safe">Thread Safe</h5>
              <p>The approach taken here is called double-checked locking (DCL). It exists to prevent race condition  between multiple threads that may attempt to get singleton instance at the same time, creating separate instances as a result. It could seem that having the 'result' variable here is completely pointless. However it is very important to have it when implementing double-checked locking in Java, which is solved by introducing this local variable. You can read more info DCL issues in Java at <a href="https://en.wikipedia.org/wiki/Double-checked_locking#Usage_in_Java">CDL Java</a>.</p>
              <h5 id="java-non-thread-safe">Non-Thread Safe</h5>
              <div include-html="../../reusable-elements/lorem-ipsum.html"></div>
              <h6 id="java-single-thread">Single Thread</h6>
              <div include-html="../../reusable-elements/lorem-ipsum.html"></div>
              <h6 id="java-multi-thread">Multi-Thread</h6>
              <div include-html="../../reusable-elements/lorem-ipsum.html"></div>
              <br>
              <h4 id="kotlin">
                Kotlin
                <a target="_blank" rel="noopener noreferrer" href="https://github.com/PitPietro/java-kotlin-design-patterns/tree/master/src/com/pit/kotlin/singleton">
                  <svg width="64" height="64" viewBox="0 0 256 256" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid">
                    <defs>
                        <linearGradient x1="26.599%" y1="146.559136%" x2="73.8446667%" y2="52.3813953%" id="linearGradient-1">
                            <stop stop-color="#0095D5" offset="9.677%"></stop>
                            <stop stop-color="#238AD9" offset="30.07%"></stop>
                            <stop stop-color="#557BDE" offset="62.11%"></stop>
                            <stop stop-color="#7472E2" offset="86.43%"></stop>
                            <stop stop-color="#806EE3" offset="100%"></stop>
                        </linearGradient>
                        <linearGradient x1="13.9840532%" y1="37.1049231%" x2="68.682392%" y2="-13.5538462%" id="linearGradient-2">
                            <stop stop-color="#0095D5" offset="11.83%"></stop>
                            <stop stop-color="#3C83DC" offset="41.78%"></stop>
                            <stop stop-color="#6D74E1" offset="69.62%"></stop>
                            <stop stop-color="#806EE3" offset="83.33%"></stop>
                        </linearGradient>
                        <linearGradient x1="-16.8361667%" y1="91.9396667%" x2="76.2191667%" y2="-1.11566667%" id="linearGradient-3">
                            <stop stop-color="#C757BC" offset="10.75%"></stop>
                            <stop stop-color="#D0609A" offset="21.38%"></stop>
                            <stop stop-color="#E1725C" offset="42.54%"></stop>
                            <stop stop-color="#EE7E2F" offset="60.48%"></stop>
                            <stop stop-color="#F58613" offset="74.3%"></stop>
                            <stop stop-color="#F88909" offset="82.32%"></stop>
                        </linearGradient>
                    </defs>
                    <g>
                        <polygon fill="url(#linearGradient-1)" points="0 256 128.426667 127.573333 256 256"></polygon>
                        <polygon fill="url(#linearGradient-2)" points="0 0 128.426667 0 0 138.666667"></polygon>
                        <polygon fill="url(#linearGradient-3)" points="128.426667 0 0 135.253333 0 256 128.426667 127.573333 256 0"></polygon>
                    </g>
                  </svg>
                </a>
              </h4>
              <h5 id="kotlin-thread-safe">Thread Safe</h5>
              <div include-html="../../reusable-elements/lorem-ipsum.html"></div>
              <h5 id="kotlin-non-thread-safe">Non-Thread Safe</h5>
              <div include-html="../../reusable-elements/lorem-ipsum.html"></div>
              <h6 id="kotlin-single-thread">Single Thread</h6>
              <div include-html="../../reusable-elements/lorem-ipsum.html"></div>
              <h6 id="kotlin-multi-thread">Multi-Thread</h6>
              <div include-html="../../reusable-elements/lorem-ipsum.html"></div>
              <br>
              <h4 id="c-sharp">
                C#
                <a target="_blank" rel="noopener noreferrer">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512" width="64" height="64" style="enable-background:new 0 0 512 512;" xml:space="preserve">
                    <path style="fill:#408BAF;" d="M505.751,6.248C501.75,2.247,496.323,0.001,490.665,0L21.332,0.03C9.55,0.028,0,9.582,0,21.363 v469.303C0,502.45,9.552,512,21.333,512h469.333c11.782,0,21.333-9.55,21.333-21.333V21.333 C512,15.677,509.753,10.249,505.751,6.248z"/>
                    <path style="fill:#387896;" d="M505.751,6.248C501.75,2.247,496.323,0.001,490.665,0L256,0.014V512h234.667 c11.782,0,21.333-9.55,21.333-21.333V21.333C512,15.677,509.753,10.249,505.751,6.248z"/>
                    <path style="fill:#D1F4FF;" d="M185.034,336.213c-31.141,0-49.735-19.085-49.735-51.052v-58.507c0-31.378,19.275-50.87,50.301-50.87 c32.528,0,49.546,21.221,49.546,42.186c0,16.442-11.816,18.216-16.895,18.216c-10.934,0-16.351-7.347-16.868-14.63 c-0.006-0.085-0.011-0.172-0.016-0.259c-0.418-8.994-4.988-12.665-15.768-12.665c-10.458,0-16.511,2.948-16.511,18.022v58.507 c0,13.444,4.518,18.212,17.267,18.212c13.35,0,14.003-5.222,15.083-13.872c1.084-8.658,7.681-14.252,16.812-14.252 c5.079,0,16.895,1.793,16.895,18.406C235.146,314.805,217.931,336.213,185.034,336.213z"/>
                    <path style="fill:#A7E5FF;" d="M332.107,328.666c-9.264,0-16.519-7.09-16.519-16.141c0-0.539,0.04-1.077,0.122-1.609l3.6-23.583 h-10.58l-4.437,28.355c-1.199,8.381-8.956,12.978-15.634,12.978c-9.262,0-16.516-7.09-16.516-16.141c0-0.519,0.037-1.04,0.114-1.556 l3.483-23.636h-5.575c-8.805,0-15.198-6.471-15.198-15.386c0-8.734,6.343-15.572,14.44-15.572h11.577l1.33-8.863h-5.733 c-8.805,0-15.196-6.551-15.196-15.576c0-8.626,6.343-15.383,14.441-15.383h11.649l4.049-25.543c0.034-0.22,0.077-0.441,0.125-0.657 c1.469-6.578,7.69-11.17,15.128-11.17c9.525,0,16.707,6.939,16.707,16.141c0,0.563-0.044,1.126-0.134,1.684l-3.123,19.547h10.887 l4.049-25.543c0.033-0.215,0.074-0.43,0.121-0.643c1.461-6.585,7.683-11.184,15.132-11.184c9.523,0,16.705,6.939,16.705,16.141 c0,0.563-0.044,1.126-0.134,1.684l-3.123,19.547h5.992c8.337,0,15.381,7.044,15.381,15.383c0,8.589-6.562,15.576-14.629,15.576 h-11.686l-1.441,8.863h5.955c8.34,0,15.387,7.131,15.387,15.572c0,8.484-6.564,15.386-14.63,15.386h-11.817l-4.447,28.534 c-0.048,0.316-0.111,0.626-0.188,0.934C346.028,323.676,339.455,328.666,332.107,328.666z M313.765,256.375h10.721l1.385-8.863 h-10.722L313.765,256.375z"/>
                  </svg>
                </a>
              </h4>
              <h5 id="c-sharp-thread-safe">Thread Safe</h5>
              <div include-html="../../reusable-elements/lorem-ipsum.html"></div>
              <h5 id="c-sharp-non-thread-safe">Non-Thread Safe</h5>
              <div include-html="../../reusable-elements/lorem-ipsum.html"></div>
              <br>
              <h4 id="php">PHP</h4>
              <h4 id="python">Python</h4>
          </div>
        </div>
        <div include-html="../../reusable-elements/footer.html"></div>
        <script>
        includeHTML();
        $('.dropdown-menu a.dropdown-toggle').on('click', function(e) {
            if (!$(this).next().hasClass('show')) {
                $(this).parents('.dropdown-menu').first().find('.show').removeClass('show');
            }
            var $subMenu = $(this).next('.dropdown-menu');
            $subMenu.toggleClass('show');
            $(this).parents('li.nav-item.dropdown.show').on('hidden.bs.dropdown', function(e) {
                $('.dropdown-submenu .show').removeClass('show');
            });
            return false;
        });
        </script>
    </body>
</html>